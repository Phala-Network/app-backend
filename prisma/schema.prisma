generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model accounts {
  id                 Int                        @id @default(autoincrement())
  address            String?                    @unique(map: "index_accounts_on_address")
  created_at         Unsupported("datetime(6)")
  updated_at         Unsupported("datetime(6)")
  stake_pool_stakers stake_pool_stakers[]
  stake_pools        stake_pools[]
  worker_activities  worker_activities[]
  workers            workers[]
}

model ar_internal_metadata {
  key        String                     @id
  value      String?
  created_at Unsupported("datetime(6)")
  updated_at Unsupported("datetime(6)")
}

model events {
  id                           Int                            @id @default(autoincrement())
  block_number                 BigInt
  timestamp                    DateTime
  tokenomic_version            Int
  section                      String
  name                         String
  data                         String?
  skipped                      Boolean                        @default(false)
  note                         String?
  created_at                   DateTime?
  processed_at                 DateTime?
  stake_pool_activities        stake_pool_activities[]
  stake_pool_staker_activities stake_pool_staker_activities[]
  worker_activities            worker_activities[]
}

model miners {
  id                        Int                        @id @default(autoincrement())
  address                   String                     @unique(map: "index_miners_on_address")
  worker_id                 Int
  stake_pool_id             Int?
  last_updated_block_number BigInt
  last_updated_timestamp    DateTime
  state                     String                     @default("")
  v                         Decimal                    @default(0.0)
  ve                        Decimal                    @default(0.0)
  p_init                    Int                        @default(0)
  p_instant                 Int                        @default(0)
  total_reward              Decimal                    @default(0.0)
  share                     Decimal                    @default(0.0)
  created_at                Unsupported("datetime(6)")
  updated_at                Unsupported("datetime(6)")
  stake_pools               stake_pools?               @relation(fields: [stake_pool_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  workers                   workers                    @relation(fields: [worker_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([stake_pool_id], map: "index_miners_on_stake_pool_id")
  @@index([worker_id], map: "index_miners_on_worker_id")
}

model schema_migrations {
  version String @id
}

model stake_pool_activities {
  id                   Int                        @id @default(autoincrement())
  event_id             Int?
  stake_pool_id        Int
  type                 String
  block_number         BigInt
  timestamp            DateTime
  tokenomic_version    Int
  commission           Decimal                    @default(0.0)
  owner_reward         Decimal                    @default(0.0)
  cap                  Decimal                    @default(0.0)
  reward_acc           Decimal                    @default(0.0)
  total_shares         Decimal                    @default(0.0)
  total_stake          Decimal                    @default(0.0)
  free_stake           Decimal                    @default(0.0)
  releasing_stake      Decimal                    @default(0.0)
  commission_ratio     Decimal                    @default(0.0)
  used_stake           Decimal                    @default(0.0)
  stakers_count        Int                        @default(0)
  workers_count        Int                        @default(0)
  mining_workers_count Int                        @default(0)
  apr                  Decimal                    @default(0.0)
  created_at           Unsupported("datetime(6)")
  updated_at           Unsupported("datetime(6)")
  events               events?                    @relation(fields: [event_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  stake_pools          stake_pools                @relation(fields: [stake_pool_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([stake_pool_id], map: "index_stake_pool_activities_on_stake_pool_id")
  @@index([event_id], map: "index_stake_pool_activities_on_event_id")
}

model stake_pool_staker_activities {
  id                   Int                        @id @default(autoincrement())
  event_id             Int?
  stake_pool_staker_id Int
  type                 String
  block_number         BigInt
  timestamp            DateTime
  tokenomic_version    Int
  locked               Decimal                    @default(0.0)
  shares               Decimal                    @default(0.0)
  available_rewards    Decimal                    @default(0.0)
  reward_debt          Decimal                    @default(0.0)
  created_at           Unsupported("datetime(6)")
  updated_at           Unsupported("datetime(6)")
  events               events?                    @relation(fields: [event_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  stake_pool_stakers   stake_pool_stakers         @relation(fields: [stake_pool_staker_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([stake_pool_staker_id], map: "index_stake_pool_staker_activities_on_stake_pool_staker_id")
  @@index([event_id], map: "index_stake_pool_staker_activities_on_event_id")
}

model stake_pool_stakers {
  id                           Int                            @id @default(autoincrement())
  user_id                      Int
  stake_pool_id                Int
  last_updated_block_number    BigInt
  last_updated_timestamp       DateTime
  locked                       Decimal                        @default(0.0)
  shares                       Decimal                        @default(0.0)
  available_rewards            Decimal                        @default(0.0)
  reward_debt                  Decimal                        @default(0.0)
  is_owner                     Boolean                        @default(false)
  created_at                   Unsupported("datetime(6)")
  updated_at                   Unsupported("datetime(6)")
  stake_pools                  stake_pools                    @relation(fields: [stake_pool_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts                     accounts                       @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  stake_pool_staker_activities stake_pool_staker_activities[]

  @@index([stake_pool_id], map: "index_stake_pool_stakers_on_stake_pool_id")
  @@index([user_id], map: "index_stake_pool_stakers_on_user_id")
}

model stake_pools {
  id                        Int                        @id @default(autoincrement())
  pid                       BigInt                     @unique(map: "index_stake_pools_on_pid")
  owner_address             String
  owner_id                  Int
  last_updated_block_number BigInt                     @default(0)
  last_updated_timestamp    DateTime
  commission                Decimal                    @default(0.0)
  owner_reward              Decimal                    @default(0.0)
  cap                       Decimal                    @default(0.0)
  reward_acc                Decimal                    @default(0.0)
  total_shares              Decimal                    @default(0.0)
  total_stake               Decimal                    @default(0.0)
  free_stake                Decimal                    @default(0.0)
  releasing_stake           Decimal                    @default(0.0)
  commission_ratio          Decimal                    @default(0.0)
  used_stake                Decimal                    @default(0.0)
  stakers_count             Int                        @default(0)
  workers_count             Int                        @default(0)
  mining_workers_count      Int                        @default(0)
  apr                       Decimal                    @default(0.0)
  created_at                Unsupported("datetime(6)")
  updated_at                Unsupported("datetime(6)")
  accounts                  accounts                   @relation(fields: [owner_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  miners                    miners[]
  stake_pool_activities     stake_pool_activities[]
  stake_pool_stakers        stake_pool_stakers[]
  worker_activities         worker_activities[]
  workers                   workers[]

  @@index([owner_id], map: "index_stake_pools_on_owner_id")
  @@index([owner_address], map: "index_stake_pools_on_owner_address")
}

model states {
  id             Int                        @id @default(autoincrement())
  key            String?
  visible        Boolean?
  decimal_value  Decimal?
  integer_value  Int?
  string_value   String?
  datetime_value DateTime?
  created_at     Unsupported("datetime(6)")
  updated_at     Unsupported("datetime(6)")

  @@index([key], map: "index_states_on_key")
}

model worker_activities {
  id                    Int                        @id @default(autoincrement())
  event_id              Int?
  worker_id             Int
  type                  String
  block_number          BigInt
  timestamp             DateTime
  tokenomic_version     Int
  operator_address      String?
  operator_id           Int?
  ecdh_public_key       String?
  runtime_version       Int                        @default(0)
  confidence_level      Int                        @default(0)
  features              Int?
  initial_score         Int                        @default(0)
  info_last_updated_at  DateTime
  pid                   BigInt?
  stake_pool_id         Int?
  miner_account_address String?
  state                 String                     @default("")
  v                     Decimal                    @default(0.0)
  ve                    Decimal                    @default(0.0)
  p_init                Int                        @default(0)
  p_instant             Int                        @default(0)
  total_reward          Decimal                    @default(0.0)
  s_min                 Decimal                    @default(0.0)
  s_max                 Decimal                    @default(0.0)
  share                 Decimal                    @default(0.0)
  created_at            Unsupported("datetime(6)")
  updated_at            Unsupported("datetime(6)")
  events                events?                    @relation(fields: [event_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts              accounts?                  @relation(fields: [operator_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  stake_pools           stake_pools?               @relation(fields: [stake_pool_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  workers               workers                    @relation(fields: [worker_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([miner_account_address], map: "index_worker_activities_on_miner_account_address")
  @@index([stake_pool_id], map: "index_worker_activities_on_stake_pool_id")
  @@index([operator_id], map: "index_worker_activities_on_operator_id")
  @@index([worker_id], map: "index_worker_activities_on_worker_id")
  @@index([event_id], map: "index_worker_activities_on_event_id")
}

model workers {
  id                        Int                        @id @default(autoincrement())
  public_key                String                     @unique(map: "index_workers_on_public_key")
  last_updated_block_number BigInt
  last_updated_timestamp    DateTime
  operator_address          String?
  operator_id               Int?
  ecdh_public_key           String?                    @unique(map: "index_workers_on_ecdh_public_key")
  runtime_version           Int                        @default(0)
  confidence_level          Int                        @default(0)
  features                  Int?
  initial_score             Int                        @default(0)
  info_last_updated_at      DateTime
  pid                       BigInt?
  stake_pool_id             Int?
  miner_account_address     String?
  state                     String                     @default("")
  v                         Decimal                    @default(0.0)
  ve                        Decimal                    @default(0.0)
  p_init                    Int                        @default(0)
  p_instant                 Int                        @default(0)
  total_reward              Decimal                    @default(0.0)
  s_min                     Decimal                    @default(0.0)
  s_max                     Decimal                    @default(0.0)
  share                     Decimal                    @default(0.0)
  created_at                Unsupported("datetime(6)")
  updated_at                Unsupported("datetime(6)")
  accounts                  accounts?                  @relation(fields: [operator_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  stake_pools               stake_pools?               @relation(fields: [stake_pool_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  miners                    miners[]
  worker_activities         worker_activities[]

  @@index([miner_account_address], map: "index_workers_on_miner_account_address")
  @@index([stake_pool_id], map: "index_workers_on_stake_pool_id")
  @@index([pid], map: "index_workers_on_pid")
  @@index([operator_id], map: "index_workers_on_operator_id")
  @@index([operator_address], map: "index_workers_on_operator_address")
}

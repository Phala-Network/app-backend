query StakePools(
  $where: StakePoolsWhereInput
  $orderBy: [StakePoolsOrderByWithRelationInput!]
  $take: Int
  $skip: Int
  $withStakePoolStakers: Boolean = false
  $stakePoolStakersWhere: StakePoolStakersWhereInput
  $withStakePoolWithdrawals: Boolean = false
  $stakePoolWithdrawalsWhere: StakePoolWithdrawalsWhereInput
) {
  findManyStakePools(
    where: $where
    orderBy: $orderBy
    take: $take
    skip: $skip
  ) {
    pid
    ownerAddress
    commission
    ownerReward
    cap
    rewardAcc
    totalShares
    totalStake
    freeStake
    releasingStake
    usedStake
    remainingStake
    stakersCount
    workersCount
    miningWorkersCount
    instantApr
    stakePoolStakers(where: $stakePoolStakersWhere)
      @include(if: $withStakePoolStakers) {
      address
      shares
      locked
      availableRewards
      rewardDebt
      stake
      pendingRewards
      stakeRewards
      claimableRewards
      instantClaimableRewards
      isOwner
    }
    accounts {
      identity
      identityVerified
    }
    stakePoolWithdrawals(where: $stakePoolWithdrawalsWhere)
      @include(if: $withStakePoolWithdrawals) {
      shares
      startTime
      estimatesEndTime
      stake
      userAddress
    }
  }
  aggregateStakePools(where: $where) {
    _count {
      _all
    }
  }
}

query TotalStake {
  aggregateStakePools {
    _sum {
      totalStake
    }
  }
}
